class lpd8_ext extends lpd8 {
		string WAV[0];
/*		WAV << "../_SAMPLES/DUB_SET/Bass_Drum1_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Bass_Drum2_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Bass_Drum_Hip_Hop1_01.wav";
		WAV << "../_SAMPLES/DUB_SET/Crash_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Crash_Effected_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Crash_Splash_Dub.wav";
		WAV << "../_SAMPLES/DUB_SET/Drum_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Fxhits2_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Fxhits4_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Fxhits5_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Fxhits6_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Hand_Clap1_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Hand_Clap_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Hi_Hat_Closed2_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Hi_Hat_Open2_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Hi_Hat_Open_1_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Hi_Hat_Open_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Ride_Cymbal1_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Ride_Cymbal_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Rim_Shot_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Scratch1_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Scratch3_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Snare_Drum1_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Snare_Drum2_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Snare_Drum3_Dub1.wav";
		WAV << "../_SAMPLES/DUB_SET/Tomglide.wav";
		WAV << "../_SAMPLES/DUB_SET/wicked_Bass_Dub1.wav";

*/

		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo01_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo01_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo02_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo02_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo03_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo03_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo04_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo04_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo05_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo05_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo06_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo06_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo07_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo07_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo08_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo08_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo09_Reggae.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo09_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo10_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bass_DrumVelo10_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bongo1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Bongo2.wav";
/*		WAV<<"../_SAMPLES/REGGAE_SET_2/China_CrashVelo01_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/China_CrashVelo02_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/China_CrashVelo03_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/China_CrashVelo04_Reggae1.wav"; */
		WAV<<"../_SAMPLES/REGGAE_SET_2/China_CrashVelo05_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Conga_1.wav";
/*		WAV<<"../_SAMPLES/REGGAE_SET_2/Crash_DarkVelo01_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Crash_DarkVelo02_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Crash_DarkVelo03_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Crash_DarkVelo04_Reggae1.wav"; */
		WAV<<"../_SAMPLES/REGGAE_SET_2/Crash_DarkVelo05_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_ClosedVelo01_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_ClosedVelo02_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_ClosedVelo03_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_ClosedVelo04_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_ClosedVelo05_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_ClosedVelo06_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_ClosedVelo07_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_ClosedVelo08_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_ClosedVelo09_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_ClosedVelo10_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_StompedVelo01_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_StompedVelo02_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_StompedVelo03_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_StompedVelo04_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_StompedVelo05_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_StompedVelo06_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_StompedVelo07_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_StompedVelo08_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_StompedVelo09_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HH_StompedVelo10_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HHatHalfopenVelo01Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HHatHalfopenVelo02Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HHatHalfopenVelo03Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HHatHalfopenVelo04Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HHatHalfopenVelo05Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HHatHalfopenVelo06Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HHatHalfopenVelo07Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HHatHalfopenVelo08Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HHatHalfopenVelo09Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/HHatHalfopenVelo10Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Hi_Hat_OpenVelo01_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Hi_Hat_OpenVelo02_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Hi_Hat_OpenVelo03_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Hi_Hat_OpenVelo04_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Hi_Hat_OpenVelo05_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Hi_Hat_OpenVelo06_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Hi_Hat_OpenVelo07_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Hi_Hat_OpenVelo08_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Hi_Hat_OpenVelo09_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Hi_Hat_OpenVelo10_Reggae1.wav";
/*		WAV<<"../_SAMPLES/REGGAE_SET_2/Ride_CymbalVelo01_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Ride_CymbalVelo02_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Ride_CymbalVelo03_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Ride_CymbalVelo04_Reggae1.wav"; */
		WAV<<"../_SAMPLES/REGGAE_SET_2/Ride_CymbalVelo05_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Ride_KuppeVelo01_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Ride_KuppeVelo02_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Ride_KuppeVelo03_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Ride_KuppeVelo04_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Ride_KuppeVelo05_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Rim_Shot.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Rimshot_Velo01_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Rimshot_Velo02_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Rimshot_Velo03_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Rimshot_Velo04_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Rimshot_Velo05_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Rimshot_Velo06_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Rimshot_Velo07_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Rimshot_Velo08_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Rimshot_Velo09_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Rimshot_Velo10_Reggae1.wav";
/*		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_BrushVelo01_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_BrushVelo02_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_BrushVelo03_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_BrushVelo04_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_BrushVelo05_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_BrushVelo06_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_BrushVelo07_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_BrushVelo08_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_BrushVelo09_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_BrushVelo10_Metal.wav"; */
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo01_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo01_Wood.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo02_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo02_Wood.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo03_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo03_Wood.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo04_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo04_Wood.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo05_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo05_WQood.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo06_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo06_Wood.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo07_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo07_Wood.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo08_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo08_Wood.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo09_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo09_Wood.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo10_Metal.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Snare_DrumVelo10_Wood.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo01_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo01_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo02_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo02_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo03_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo03_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo04_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo04_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo05_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo05_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo06_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo06_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo07_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo07_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo08_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo08_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo09_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo09_Reggae2.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo10_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Timbales_Velo10_Reggae2.wav";
/*		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo01_High.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo01_Low.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo01_Mid.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo02_High.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo02_Low.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo02_Mid.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo03_High.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo03_Low.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo03_Mid.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo04_High.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo04_Low.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo04_Mid.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo05_High.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo05_Low.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo05_Mid.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo06_High.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo06_Low.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo06_Mid.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo07_High.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo07_Low.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo07_Mid.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo08_High.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo08_Low.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo08_Mid.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo09_High.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo09_Low.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo09_Mid.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo10_High.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo10_Low.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Tom_Velo10_Mid.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Vibraslap_Velo01_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Vibraslap_Velo02_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Vibraslap_Velo03_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Vibraslap_Velo04_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Vibraslap_Velo05_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Vibraslap_Velo06_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Vibraslap_Velo07_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Vibraslap_Velo08_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Vibraslap_Velo09_Reggae1.wav";
		WAV<<"../_SAMPLES/REGGAE_SET_2/Vibraslap_Velo10_Reggae1.wav";
*/



//		WAV << ;

		0 => int wav_index;


   0 => int last_pad;
   0 => int last_pad_up;
   0 => int pad_active_nb;
   0 => int pad_active_nb_up;

   0::ms => dur groove_offset;
   -1 => int grv_potar_init;

		Gain final => global_mixer.line4;


  fun void f1 (){ 
		SndBuf s => final;
		.3 => s.gain;

		WAV[wav_index] => s.read;
		s.length() => now;



	 } 

   fun void play_hh(int pad){
				// sync
				Math.pow(2,pad) => float ratio;
        
				groove_offset/ratio => dur offset;
		    if(offset != 0::ms) <<<"GROOVE OFFSET =", offset/1::ms, " ms">>>;

				data.tick/ratio + offset - ((now - data.wait_before_start) % ( data.tick / ratio )) => now;

				while (pad_active_nb > 0 && last_pad == pad){
					spork ~ f1 ();
				  data.tick/ ratio => now;
				}

	 }


   fun void play_hh_up(int pad){
				// sync
				Math.pow(2,pad - 4) => float ratio;

				groove_offset/ratio => dur offset;
		    if(offset != 0::ms) <<<"GROOVE OFFSET =", offset/1::ms, " ms">>>;

        data.tick/ratio + offset  - ((now - data.wait_before_start -  data.tick / (2 *ratio) ) % ( data.tick / ratio )) => now;

				while (pad_active_nb_up > 0 && last_pad_up == pad){
					spork ~ f1 ();
				  data.tick/ ratio => now;
				}

	 }


//	 spork ~ f1 ();
	  


	    // PADS
			fun void pad_ext (int group_no, int pad_nb, int val) {
//						<<<group_no, pad_nb, val>>>;
						 36-=> pad_nb;
				   if (group_no == 144) {

								if (pad_nb < 4) {
								    pad_active_nb ++;
										pad_nb => last_pad;
								    spork~play_hh(pad_nb);
//										<<<pad_nb,pad_active_nb>>>;
								}
								else {
								    pad_active_nb_up ++;
										pad_nb => last_pad_up;
								    spork~play_hh_up(pad_nb);
								}
						 }
			       else if (group_no == 128 ) {
										if (pad_nb < 4) {
												pad_active_nb --; 
//										<<<pad_nb,pad_active_nb>>>;
										}
										else {
												pad_active_nb_up --; 
										}
								 }
}

			    // POTARS
					fun void potar_ext (int group_no, int pad_nb, int val) {
						    if (group_no == 176) {

									if (pad_nb  == 1)      { val $ float / 64. => final.gain;}   
									else if (pad_nb  == 2) {
												val / (127 / WAV.size()) => wav_index;
												if (wav_index >= WAV.size()) WAV.size() - 1 => wav_index;
												<<<wav_index, WAV[wav_index] >>>;

												0::ms => groove_offset;
												-1 => grv_potar_init;
										}
									else if (pad_nb  == 3) {}
									else if (pad_nb  == 4) {
										// GROOVE OFFSET
										if (grv_potar_init == -1) val => grv_potar_init;
										else (val - grv_potar_init)*data.tick/(127.*2.) => groove_offset;

										<<<"GROOVE OFFSET =", groove_offset/1::ms, " ms, ", groove_offset/data.tick, " tick">>>;

										}
									else if (pad_nb  == 5) {}
									else if (pad_nb  == 6) {}
									else if (pad_nb  == 7) {}
										}    
					}
}

lpd8_ext lpd;

while (1) 1::second => now; 
